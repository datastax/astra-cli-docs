= Connect and configure the {product}
:navtitle: Connect and configure

Initialize the {product} and run your first commands.

== Connect to {product-short}

After xref:ROOT:install.adoc[installing the {product}], follow these steps to set up your first connection profile:

. {astra-url}[Sign in or create an {product-short} account.^]

. Generate an xref:astra-db-serverless:administration:manage-application-tokens.adoc[application token] with a role that has adequate permissions to perform the tasks you want to accomplish with the {product}.
+
--
* *Non-production organizations*: If your {product-short} organization has no databases or streaming tenants that handle sensitive information, you can grant your application token the `Organization Administrator` role to try out all of the {product} features.

* *Production organizations*: If you're using {product-short} in production, {company} recommends that you use a more limited xref:astra-db-serverless:administration:manage-database-access.adoc#built-in-organization-roles[built-in role] or xref:astra-db-serverless:administration:manage-database-access.adoc#custom-roles[custom role] to grant your application token the bare minimum permissions required to perform your desired tasks with the {product}.
--

. Run the `astra setup` command to to create your first connection profile:
+
[source,bash]
----
astra setup
----
+
.Result
[%collapsible]
====
[source,console,subs="+attributes"]
----
     _____            __
    /  _  \   _______/  |_____________
   /  /_\  \ /  ___/\   __\_  __ \__  \
  /    |    \\___ \  |  |  |  | \ //__ \_
  \____|__  /____  > |__|  |__|  (____  /
          \/     \/                   \/

                       Version: {product-version}

Welcome to the Astra CLI setup!

A configuration file with your profile will be created at /Users/USERNAME/.astrarc

If you'd prefer to provide credentials on a per-command basis rather than storing them in a file, you can either:
- Use the per-command --token flag to pass your existing AstraCS token directly.
- Use the per-command --config-file flag to specify an existing .astrarc file.

# Example:
$ astra db list --token <your_token>

Press Enter to continue, or use Ctrl+C to cancel.
----
====

. When prompted, enter your {product-short} application token and press kbd:[Enter].

. Enter a name for your connection profile or press kbd:[Enter] to accept the default (your organization name).
+
.Result
[%collapsible]
====
[source,console,subs="+quotes"]
----
Profile PROFILE_NAME successfully created.

It has been set as the default profile.
----
====

. Test your connection by running a simple command, such as listing your databases:
+
[source,bash]
----
astra db list
----
+
If the command succeeds, your connection is configured correctly.
If your command fails, see the xref:commands:astra-setup.adoc[astra setup command] documentation for troubleshooting tips.

[#file-locations]
== Installation file locations

The {product} and its configuration are installed in the following locations:

[cols="1,2"]
|===
|File location |Description

|`~/.astra`
a|The {product} installation directory.

For <<install-curl,curl-based installations>>, the `astra` executable and `astra-init.sh` auto-completion script are located in `~/.astra/cli`.
The `~/.astra/cli` folder is added to the `PATH` environment variable.
_This folder is deleted and recreated when you update or re-install the {product}._

For <<install-homebrew,Homebrew-based installations>>, the `astra` executable and auto-completion script are located in https://docs.brew.sh/FAQ#why-should-i-install-homebrew-in-the-default-location[Homebrew's default prefix] at the following locations:

* Executable: `HOMEBREW_PREFIX/Cellar/astra-cli/VERSION/bin/astra`
* Auto-completion script: `HOMEBREW_PREFIX/Cellar/astra-cli/VERSION/etc/bash_completion.d/astra`

|`~/.astrarc`
|The {product} configuration file.

_This file is *not* deleted when you update or re-install the {product}._
|===

== Print help information

Simply print `astra` to print general {product} help information:

[source,bash]
----
astra
----

.Result
[%collapsible]
====
[source,console]
----

     _____            __
    /  _  \   _______/  |_____________
   /  /_\  \ /  ___/\   __\_  __ \__  \
  /    |    \\___ \  |  |  |  | \ //__ \_
  \____|__  /____  > |__|  |__|  (____  /
          \/     \/                   \/

                       Version: 1.0.0-rc.4

Documentation: https://docs.datastax.com/en/astra-cli

Usage: astra [-qVv] [--no-input] [--[no-]spinner] [--dump-logs[=FILE]]
             [--color=WHEN] [-o=FORMAT] [COMMAND]

  -v, --version            Print version information and exit.
                             (default: false)

Common Options:
      --color=WHEN         One of: auto, never, always
                             (default: auto)
      --dump-logs[=FILE]   Write all logs to an optionally specified file
                             (default: ~/.astra-dev/logs/<file>.log)
      --no-input           Don't ask for user input (e.g. confirmation prompts)
  -o, --output=FORMAT      One of: human, json, csv
                             (default: human)
  -q, --quiet              Only output essential information
      --[no-]spinner       Enable/disable loading spinners
                             (default: enabled if tty)
  -V, --verbose            Enable verbose logging output

Commands:
  setup      Interactively set up the Astra CLI and create profiles
  config     Manage your Astra CLI configuration profiles
  db         Manage your Astra databases
  pcu        Manage your PCU groups and associations
  org        Get organization information
  role       Discover Astra roles
  streaming  Manage Astra streaming tenants
  token      Manage your Astra tokens
  user       Manage users in your organization
  upgrade    Upgrade your Astra CLI installation
  shellenv   Completions, configuration, and more
  nuke       Entirely delete Astra CLI from your system

Examples:
  # Create a new profile
  $ astra setup

  # List databases
  $ astra db list

  # Create a vector database
  $ astra db create demo -r us-east1

See 'astra <command> <subcommand> --help' for help on a specific subcommand.
----
====

Use the `--help` (or `-h`) flag to print help information and examples for an individual command:


.Result
[%collapsible]
====
[source,console]
----
Usage: astra db [-qvV] [--no-input] [--[no-]spinner] [--dump-logs[=FILE]]
                [--color=WHEN] [-o=FORMAT] [[[-cf=PATH] [-p=NAME]] |
                [--token=TOKEN [--env=ENV]]] [COMMAND]

Manage your Astra databases

  -v, --vector             Only show vector-enabled databases
                             (default: false)

Common Options:
      --color=WHEN         One of: auto, never, always
                             (default: auto)
      --dump-logs[=FILE]   Write all logs to an optionally specified file
                             (default: ~/.astra-dev/logs/<file>.log)
      --no-input           Don't ask for user input (e.g. confirmation prompts)
  -o, --output=FORMAT      One of: human, json, csv
                             (default: human)
  -q, --quiet              Only output essential information
      --[no-]spinner       Enable/disable loading spinners
                             (default: enabled if tty)
  -V, --verbose            Enable verbose logging output

Connection Options:
      -cf, --config-file=PATH
                           The .astrarc file to use for this command
                             (default: ~/.astrarc-dev)
      --env=ENV            Override the target astra environment
  -p, --profile=NAME       The .astrarc profile to use for this command
      --token=TOKEN        The astra token to use for this command. Use the
                             --token @file syntax to read the token from a
                             file, to avoid potential leaks.

Commands:
  list                      List your non-terminated Astra databases.
  get, describe             Get information about a specific database.
  create                    Create a new Astra database
  delete                    Delete an existing Astra database
  status                    Get the current status of a database.
  cqlsh                     Connect to your Astra database using cqlsh
  dsbulk                    Use dsbulk to interface with your Astra DB database
  create-dotenv             Create a env file to help you connect to your Astra
                              DB instance.
  download-scb              Download secure connect bundle for a database
  resume                    Resume a database that is in a stopped state. If
                              the database is already active, no action is
                              taken.
  list-keyspaces            List all keyspaces in the specified database
  create-keyspace           Create a new keyspace in the specified database
  delete-keyspace           Delete a keyspace from the specified database
  list-collections          List the collections in the specified database and
                              keyspace
  create-collection         Create a new Data API collection in the specified
                              database and keyspace
  describe-collection       Describe an existing Data API collection with
                              detailed information including vector
                              configuration and indexing options
  delete-collection         Delete an existing Data API collection from the
                              specified database and keyspace
  truncate-collection       Atomically delete all documents in a Data API
                              collection
  list-tables               List the tables in the specified database and
                              keyspace
  describe-table            Describe an existing table with detailed
                              information including columns and primary key
                              structure
  delete-table              Delete an existing table from the specified
                              database and keyspace
  truncate-table            Atomically delete all rows in a table
  list-embedding-providers  Find all available embedding providers for a given
                              database
  list-cdcs                 List all CDC (Change Data Capture) connections for
                              the specified database
  create-cdc                Create a CDC (Change Data Capture) for a table in a
                              specific keyspace and tenant.
  delete-cdc                Delete a CDC (Change Data Capture) from the database
  create-region             Add a new region to an existing database
  delete-region             Delete a region from an existing database
  list-regions              List the regions for the given database
  list-regions-classic      List all available regions for classic Astra DB
                              databases
  list-regions-serverless   List all available regions for serverless Astra DB
                              databases
  list-regions-vector       List all available regions for vector Astra DB
                              databases
  list-clouds               List all cloud providers with regions available for
                              Astra DB
  get-endpoint-swagger      Get the SwaggerUI endpoint for the specified
                              database
  get-endpoint-api          Get the API endpoint to interact with the specified
                              database
  get-endpoint-playground   Get the GraphQL Playground for the specified
                              database

Examples:
  # List all your Astra databases
  $ astra db

  # List only vector-enabled Astra databases
  $ astra db --vector

See 'astra <command> <subcommand> --help' for help on a specific subcommand.
----
====

Append a subcommand for further specificity:

[source,bash]
----
astra db list --help
----

.Result
[%collapsible]
====
[source,console]
----
Usage: astra db list [-qvV] [--no-input] [--[no-]spinner] [--dump-logs[=FILE]]
                     [--color=WHEN] [-o=FORMAT] [[[-cf=PATH] [-p=NAME]] |
                     [--token=TOKEN [--env=ENV]]]

List your non-terminated Astra databases.

  -v, --vector             Only show vector-enabled databases
                             (default: false)

Common Options:
      --color=WHEN         One of: auto, never, always
                             (default: auto)
      --dump-logs[=FILE]   Write all logs to an optionally specified file
                             (default: ~/.astra-dev/logs/<file>.log)
      --no-input           Don't ask for user input (e.g. confirmation prompts)
  -o, --output=FORMAT      One of: human, json, csv
                             (default: human)
  -q, --quiet              Only output essential information
      --[no-]spinner       Enable/disable loading spinners
                             (default: enabled if tty)
  -V, --verbose            Enable verbose logging output

Connection Options:
      -cf, --config-file=PATH
                           The .astrarc file to use for this command
                             (default: ~/.astrarc-dev)
      --env=ENV            Override the target astra environment
  -p, --profile=NAME       The .astrarc profile to use for this command
      --token=TOKEN        The astra token to use for this command. Use the
                             --token @file syntax to read the token from a
                             file, to avoid potential leaks.

Examples:
  # List all your Astra databases
  $ astra db list

  # List only vector-enabled Astra databases
  $ astra db list --vector

See 'astra <command> <subcommand> --help' for help on a specific subcommand.
----
====

== Using auto-completion

The {product} provides Bash auto-completion for `bash` and `zsh` shells.

See the xref:install.adoc[installation instructions] for your platform to enable auto-completion.

To use auto-completion, type the `astra` command and then press kbd:[Tab] twice to get a list of available options.

[source,bash,subs="macros"]
----
astra kbd:[Tab] kbd:[Tab]
----

.Result
[%collapsible%open]
====
[source,console]
----
config     nuke       pcu        setup      streaming  upgrade
db         org        role       shellenv   token      user
----
====

Certain dynamic arguments, such as database names, also support auto-completion once the CLI discovers them.

For example, after running `astra db list`, type a `astra db get` followed by kbd:[Tab] twice to see a list of your database names.

[source,bash,subs="macros"]
----
astra db get kbd:[Tab] kbd:[Tab]
----

.Result
[%collapsible%open]
====
[source,console]
----
prod_db    test_db    playground_db
----
====

[#manage-configuration]
== Manage your {product} configuration

When you run the `astra setup` command during <<initialize,initialization>>, the {product} stores your application token as the default configuration in the `~/.astrarc` configuration file.

You can create additional configuration profiless, each with their own application token, to make it easier to manage different types of resources across one or more organizations.

=== Get and set configurations

. Use `astra config list` to list all current configuration profiles:
+
[source,bash]
----
astra config list
----
+
.Result
[%collapsible]
====
[source,console]
----
┌───────────────────────────────────┐
│ configuration                     │
├───────────────────────────────────┤
│ Production (in use)               │
│ Testing                           │
└───────────────────────────────────┘
----
====

. Use `astra config create` or `astra setup` again to create a new configuration profile:
+
[source,bash,subs="+quotes"]
----
astra config create "**CONFIG_NAME**" --token **APPLICATION_TOKEN**
----
+
.Result
[%collapsible]
====
[source,console,subs="+quotes"]
----
Configuration profile '**CONFIG_NAME**' successfully created.

(Hint: Use 'astra setup' for an interactive profile creation experience!)

# Set it as the default profile:
$ astra config use **CONFIG_NAME**
----
====

. Use `astra config use` to change the default configuration that {product} uses when executing commands:
+
[source,bash,subs="+quotes"]
----
astra config use "**CONFIG_NAME**"
----
+
.Result
[%collapsible]
====
[source,console,subs="+quotes"]
----
Default profile set to '**CONFIG_NAME**'.
----
====

. Optional: Rerun `astra config list` to verify that the new default configuration is set.

=== Set the configuration for a single run

Every {product} command supports the `--profile` option.
This option lets you use a different configuration profile when running a command without changing the default configuration profile.
For example:

[source,bash,subs="+quotes"]
----
astra user list --config "**CONFIG_NAME**"
----

Alternatively, you can use the `--token` option to supply an application token when running a command.
This option lets you use a different application token without having to create a new configuration.
For example:

[source,bash,subs="+quotes"]
----
astra user list --token "**APPLICATION_TOKEN**"
----

=== Delete a configuration profile

Use `astra config delete` to delete a configuration profile:

[source,bash,subs="+quotes"]
----
astra config delete "**CONFIG_NAME**"
----

.Result
[%collapsible]
====
[source,console,subs="+quotes"]
----
Profile 'tem' deleted successfully.
----
====

[IMPORTANT]
====
If you delete the default configuration, the {product} _doesn't_ automatically select a new default configuration.
Use the `astra config use` command to select a new default configuration.
====

== Next steps

* xref:ROOT:managing.adoc[]
* xref:ROOT:astra-streaming-cli.adoc[]
* xref:ROOT:administration.adoc[]
